<div id="newTaskModal" class="modal fade new-task-modal" role="dialog" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">

      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h2 class="modal-title sign_up_show">Create New Task</h2>
      </div>

      <div class="modal-body">
        <%= simple_form_for(Task.new) do |f| %>
          <%= f.error_notification %>

          <%= render 'shared/error_messages', object: f.object %>

          <div class="form-inputs">
            <div class="form-group">
              <%= f.input :title, class: '', required: true %>
            </div>
            <div class="form-group">
              <%= f.input :description, required: true %>
            </div>
            <div class="form-group">
              <%= f.input :budget, required: true %>
            </div>
            <div class="form-group">
              <%= f.input :condition_of_execution, required: true %>
            </div>
            <div class="form-group">
              <%= f.input :proof_of_execution, required: true %>
            </div>

            <div class="deadline-group">
                <div class="form-group">
                    <label class="text required" for="deadline">* Deadline</label>
                    <div class='input-group date' id='deadline_picker'>
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-calendar">
                            </span>
                        </span>
                        <input type='text' class="form-control" id="deadline_input" required="required" aria-required="true" />
                    </div>
                </div>
                <script type="text/javascript">
                    $(function () {
                        $('#deadline_picker').datetimepicker({
                            viewMode: 'years',
                            format: 'YYYY-MM-DD HH:mm A'
                        });
                    });
                </script>
            </div>

            <div class="form-group">
              <%= f.input :target_number_of_participants, required: true %>
            </div>

            <input name="task[deadline]" id="deadline_field" type="hidden">

            <%= f.hidden_field :project_id, value: @project.id %>
          </div>

          <div class="form-actions text-right">
            <%= f.button :submit, class: 'btn-default-weserve' %>
          </div>
        <% end %>

      </div>

    </div>
  </div>
</div>

<script type="text/javascript">
  $('form#new_task').submit(function(){
    beforeSubmit(function(){
      var deadline = $( "#deadline_input").val();
      $("#deadline_field").val(deadline);
    });
  });
  function beforeSubmit(fn) {
    fn();
  }
</script>
