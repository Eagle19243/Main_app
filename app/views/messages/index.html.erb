
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>We Serve</title>
  <%= stylesheet_link_tag 'messagescreen' %>
  <script src="https://cdn.firebase.com/v0/firebase.js"></script>
  <%= stylesheet_link_tag 'firechat_merge' %>
  <%= javascript_include_tag 'messagescreen' %>
  <%= javascript_include_tag 'firechat_merged' %>

</head>
<body>
<%= render 'layouts/menu' %>



<div class="main">
  <div class="row messages-page-row">
    <!-- Main nav -->
    <!--users/_sidebar.html.erb-->
    <%= render 'users/sidebar' %>

    <!-- Messages and projects nav -->
    <div class="small-2 columns full-page" id="messages-nav">
      <br>
      <div class="messages-nav-title">
        <i class="fa fa-file-text-o fa-2x" aria-hidden="true"></i>
        <span>Messages</span>
      </div>
      <div class="messages-menu">
        <div class="messages-submenu">
          <div class="submenu-title">
            <span class="menu-subtitle">PROJECTS (<%= @projects.count %>)</span>
            <i class="fa fa-plus-circle" aria-hidden="true"></i>
          </div>
          <ul class="circle">
            <% @projects.each do |project| %>
                <li><a href='#' id="<%= project.chat_room.room_id %>" onclick="Enter_Room('<%= project.chat_room.room_id %>')"> <%= project.title %></a></li>

          <% end %>


          </ul>
        </div>
        <hr>
        <div class="messages-submenu">
          <div class="submenu-title">
            <span class="menu-subtitle">DIRECT MESSAGES (3)</span>
            <i class="fa fa-plus-circle" aria-hidden="true"></i>
          </div>
          <ul class="circle">
            <li><a href="#">Eric</a></li>
            <li class="active"><a href="#">Caju</a></li>
            <li><a href="#">Tendai</a></li>
            <li><a href="#">#Group Message</a></li>
          </ul>
        </div>
        <hr>
      </div>
    </div>

    <div class="small-7 columns" id="page-message-content">
      <br>
      <div>
        <!-- Conversation name -->
        <div class="small-6 columns">
          <h4>
            #Caju Costa
          </h4>
        </div>

        <div class="small-6 columns">
          <!-- Search box -->
          <div class="small-8 columns">
            <form>
              <div class="row messages-page-row collapse">
                <div class="small-9 columns">
                  <input type="search" placeholder="search">
                </div>
                <div class="small-3 columns">
                  <span class="postfix"><i class="fa fa-search" aria-hidden="true"></i></span>
                </div>
              </div>
            </form>
          </div>
          <!-- Settings and attach file icons -->
          <div class="small-4 columns">
              <span style="margin-right: 8px;">
                <i class="fa fa-cog fa-2x" title="Settings" aria-hidden="true"></i>
              </span>
              <span>
                <i class="fa fa-paperclip fa-2x" title="Attach file" aria-hidden="true"></i>
              </span>
          </div>
        </div>
      </div>

      <hr>



      <div id="firechat-wrapper">

      </div>
      <script type='text/javascript'>
        var firechatRef = new Firebase('https://chatapp-f41bd.firebaseio.com');
        firechatRef.auth('<%= current_user.chat_token %>');
        var chat = new FirechatUI(firechatRef, document.getElementById("firechat-wrapper"));
        chat.setUser('<%= current_user.id %>', '<%= current_user.name %>');
      </script>
      <script>
        function  Enter_Room(room_id){
          chat.enterRoom(room_id);
        }
      </script>
   <span class="send-hint">
    Hit "Enter" to send
      </span>
    </div>
  </div>
</div>

<%#= javascript_include_tag 'messagescreen' %>
<%#= javascript_include_tag 'firechat_merged' %>

<%= render 'layouts/footer' %>

<script>
  $(document).foundation();
</script>
</body>
</html>